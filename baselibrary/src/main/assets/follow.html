<!DOCTYPE html>
<!--关注-->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>关注</title>
    <link rel="stylesheet" href="./css/reset.css">
    <link rel="stylesheet" href="./css/index.css">
</head>
<script src="./js/rem.js"></script>
<script src="./js/jquery.min.js"></script>
<body>
    <div class="wrap follow">
            <header>
		<span>
		    	<i class="back"></i>
		</span>	
		<span>
			<input id="textMsg" type="text">
			<i class="search"><img src="./images/reset/ic_search.png" alt=""></i>
		</span>
		<b class="details"></b>
            </header>
            <main>

            </main>
    </div>
</body>
<script>
   function getContent (data) {
        var data = JSON.parse(data);   
        for (var i=0; i<data.length; i++) {
            var nowMsg = $('main').html();
            $('main').html(nowMsg + `
                <div class="content">
                    <dl>
                        <dt></dt>
                        <dd>
                            <p>${data[i].name}</p>
                            <p>${data[i].subjectName}</p>
                        </dd>
                    </dl>
                    <div class="right">
                        <aside>
                            <img src="./images/reset/ic_message.png">
                            <i class="lMsg">留言</i>
                        </aside>
                        <aside class="flag"></aside>
                    </div>
                </div>
            `);
            if (data[i].isAttention == 1) {
                $('.flag').eq(i).html(`
                    <img class="addImg" src="./images/reset/ic_has_concerned.png">
                    <span class="removeFollow remove">取消关注</span>
                `);                
            }else {
                $('.flag').eq(i).html(`
                    <img class="removeImg" src="./images/classMsg/add_attention@2x.png" style="width: 0.6rem;">                         
                    <span class="removeFollow add">加关注</span>
                `);   
            }
            if (data[i].ico == '') {
                $('.content:eq('+i+') dl dt').html(`<img src="./images/index/tube_class@2x.png" alt="" />`);
            }else {
                $('.content:eq('+i+') dl dt').html(`<img src="${data[i].ico}" alt="" />`);
            }
        }
        
    }
    //取消关注
    $('.remove').bind('click', function () {
        var ind = $(this).parents('.content').index();
        var attUserId = JSON.parse(data)[ind].attUserId;
        var msg = JSON.stringify({"attUserId": attUserId});
        window.android.dealWithJson("deleteUserAttention",msg);
    });
    //加关注
    $('.add').bind('click', function () {
        var ind = $(this).parents('.content').index();
        var attUserId = JSON.parse(data)[ind].attUserId;
        var msg = JSON.stringify({"attUserId": attUserId});
        window.android.dealWithJson("addUserAttention",msg);
    });
    //返回上级页面
    $('.back').bind('click', function () {
       //
    });
    //点击跳转到去留言
    $('.lMsg').bind('click', function () {
        var ind = $(this).parents('.content').index();
        var name = JSON.parse(data)[ind].name;
        var userId = JSON.parse(data)[ind].userId;
        console.log('去留言'+name+", "+userId);
        window.android.goLiuYan(name,userId);
    });
    //点击查找
    $('.search').bind('click', function () {
        var msg = $('#textMsg').val();
        if(msg.length>0){
            window.android.search();
        }
    })
</script>
</html>