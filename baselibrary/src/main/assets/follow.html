<!DOCTYPE html>
<!--关注-->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>关注</title>
    <link rel="stylesheet" href="./css/reset.css">
    <link rel="stylesheet" href="./css/index.css">
</head>
<script src="./js/rem.js"></script>
<script src="./js/jquery.min.js"></script>
<body>
    <div class="wrap follow">
            <header>
		<span>
		    	<i class="back"></i>
		</span>	
		<span>
			<input type="text">
			<i class="search"><img src="./images/reset/ic_search.png" alt=""></i>
		</span>
		<b class="details"></b>
            </header>
            <main>

            </main>
    </div>
</body>
<script>
    var data = '[{"id":2,"userId":2030219,"roleId":2,"attUserId":2030219,"addTime":1521023086,"name":"\u694a\u694a","ico":"","subjectName":"\u7269\u7406","isAttention":1},{"id":1,"userId":2030219,"roleId":2,"attUserId":2029881,"addTime":1521023080,"name":"\u4f0a\u67ad","ico":"","subjectName":"\u7269\u7406","isAttention":1}]';
    function getContent (data) {
        var data = JSON.parse(data);   
        for (var i=0; i<data.length; i++) {
            var nowMsg = $('main').html();
            $('main').html(nowMsg + `
                <div class="content">
                    <dl>
                        <dt></dt>
                        <dd>
                            <p>${data[i].name}</p>
                            <p>${data[i].subjectName}</p>
                        </dd>
                    </dl>
                    <div class="right">
                        <aside>
                            <img src="./images/reset/ic_message.png">
                            <i class="lMsg">留言</i>
                        </aside>
                        <aside>
                            <img src="./images/reset/ic_has_concerned.png">
                            <span class="removeFollow">取消关注</span>
                        </aside>
                    </div>
                </div>
            `);
            if (data[i].ico == '') {
                $('.content:eq('+i+') dl dt').html(`<img src="./images/index/tube_class@2x.png" alt="" />`);
            }else {
                $('.content:eq('+i+') dl dt').html(`<img src="${data[i].ico}" alt="" />`);
            }
        }
        
    }
    getContent(data);
    //取消关注
    $('.removeFollow').bind('click', function () {
        var ind = $(this).parents('.content').index();
        var attUserId = JSON.parse(data)[ind].attUserId;
        var msg = JSON.stringify({"attUserId": attUserId});
        window.android.dealWithJson("deleteUserAttention",msg);
    });
    //返回上级页面
    $('.back').bind('click', function () {
       //
    });
    //点击跳转到去留言
    $('.lMsg').bind('click', function () {
        //console.log('去留言');
    });
</script>
</html>